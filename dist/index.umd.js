!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t(e.gundbReactHooks={},e.react)}(this,function(e,t){var n=function(e,t,n){try{return Promise.resolve(t&&n?n.encrypt(e,t):e)}catch(e){return Promise.reject(e)}},r=function(e,t,n){try{return Promise.resolve(t&&n?n.decrypt(e,t):e)}catch(e){return Promise.reject(e)}},u=function(e,t){void 0===t&&(t=100);var n,r=[];return function(u){return r.push(u),n||(n=setTimeout(function(){var t=r.reduce(function(e,t){return e[t.id]=t.data,e},{});e(t),r=[],n=null},t)),function(){clearTimeout(n),r=[],n=null}}},o=function(e,t){var n,r=t.data;switch(t.type){case"add":return Object.assign({},e,r);case"update":return Object.assign({},e,((n={})[r.nodeID]=r,n));case"remove":return delete e[r],Object.assign({},e);default:throw new Error}},c=function(){var e=t.useRef(!1);return t.useEffect(function(){return e.current=!0,function(){return e.current=!1}},[]),e},i=function(e,n){var r=t.useReducer(e,n),u=r[0],o=r[1],i=c();return[u,function(e){i.current&&o(e)}]},s=function(e){var n=t.useState(null),r=n[0];return r||(0,n[1])(e.user()),[r]};e.encryptData=n,e.decryptData=r,e.useGun=function(e,n){return[t.useState(e({peers:n}))[0]]},e.useGunNamespace=s,e.useGunKeyAuth=function(e,n,r){void 0===r&&(r=!0);var u=s(e)[0],o=t.useState(!1),c=o[0],i=o[1];return e.on("auth",function(){i(!0)}),t.useEffect(function(){u&&!u.is&&n&&r&&u.auth(n)},[r,u,n]),[u,c]},e.useGunKeys=function(e,n){var r=t.useState(n),u=r[0],o=r[1];return u||function(){try{Promise.resolve(e.pair()).then(function(e){o(e)})}catch(e){return Promise.reject(e)}}(),[u,o]},e.useGunState=function(e,s){void 0===s&&(s={appKeys:"",sea:null,interval:100});var a=s.appKeys,f=s.sea,v=s.interval;void 0===v&&(v=100);var d=t.useState(e)[0],l=i(o,{}),m=l[0],p=l[1],h=t.useRef(null),P=c();return t.useEffect(function(){var e=[];if(P.current){var t=u(function(e){p({type:"add",data:e})},v);d.on(function(n,u,o,c){try{return Promise.resolve(r(n,a,f)).then(function(n){Object.keys(n).forEach(function(r){var u=t({id:r,data:n[r]});e.push(u)}),h.current||(h.current=c)})}catch(e){return Promise.reject(e)}})}return function(){h.current&&h.current.off(),e.length&&e.forEach(function(e){return e()})}},[]),[m,{put:function(e){try{return Promise.resolve(n(e,a,f)).then(function(e){return Promise.resolve(new Promise(function(t){return d.put(e,function(){return t()})})).then(function(){})})}catch(e){return Promise.reject(e)}},remove:function(e){try{return Promise.resolve(new Promise(function(e){return d.put(null,function(){return e()})})).then(function(){p({type:"remove",data:e})})}catch(e){return Promise.reject(e)}}}]},e.useGunCollectionState=function(e,s){void 0===s&&(s={appKeys:"",sea:null,interval:100});var a=s.appKeys,f=s.sea,v=s.interval;void 0===v&&(v=100);var d=t.useState(e)[0],l=i(o,{}),m=l[0],p=l[1],h=t.useRef(null),P=c();return t.useEffect(function(){var e=[];if(P.current){var t=u(function(e){p({type:"add",data:e})},v);d.map().on(function(n,u,o,c){try{return Promise.resolve(r(n,a,f)).then(function(n){if(n){var r=t({id:u,data:Object.assign({},n,{nodeID:u})});e.push(r)}h.current||(h.current=c)})}catch(e){return Promise.reject(e)}})}return function(){h.current&&h.current.off(),e.length&&e.forEach(function(e){return e()})}},[]),[m,{addToSet:function(e,t){try{return Promise.resolve(n(e,a,f)).then(function(e){var n=t?Promise.resolve(new Promise(function(n){return d.get(t).put(e,function(){return n()})})).then(function(){}):Promise.resolve(new Promise(function(t){return d.set(e,function(){return t()})})).then(function(){});if(n&&n.then)return n.then(function(){})})}catch(e){return Promise.reject(e)}},updateInSet:function(e,t){try{return Promise.resolve(n(t,a,f)).then(function(n){return Promise.resolve(new Promise(function(t){return d.get(e).put(n,function(){return t()})})).then(function(){p({type:"update",data:Object.assign({},{nodeID:e},t)})})})}catch(e){return Promise.reject(e)}},removeFromSet:function(e){try{return Promise.resolve(new Promise(function(t){return d.get(e).put(null,function(){return t()})})).then(function(){})}catch(e){return Promise.reject(e)}}}]}});
//# sourceMappingURL=index.umd.js.map
